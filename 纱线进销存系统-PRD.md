# 纱线进销存系统 - 产品需求文档 (PRD)

**版本：** v1.0  
**更新日期：** 2025-11-27  
**文档类型：** 产品需求文档 (Product Requirements Document)

---

## 目录

1. [产品概述](#1-产品概述)
2. [核心数据模型](#2-核心数据模型)
3. [七大核心功能模块](#3-七大核心功能模块)
4. [核心业务流程](#4-核心业务流程)
5. [界面设计建议](#5-界面设计建议)
6. [技术架构建议](#6-技术架构建议)
7. [项目实施规划](#7-项目实施规划)

---

## 1. 产品概述

### 1.1 产品定位

纱线进销存系统是一款专为纱线行业设计的WEB端业务管理系统，针对纱线商品的特殊属性（**商品→色号→缸号三层结构**）提供完整的进销存管理解决方案。

### 1.2 核心价值

- ✅ 支持纱线行业特有的三层商品结构管理
- ✅ 提供完整的进销存业务闭环
- ✅ 实时库存追踪与预警
- ✅ 客户与供应商关系管理
- ✅ 多维度数据统计与分析

### 1.3 目标用户

纱线生产企业、纱线批发商、纺织品贸易商等需要管理纱线商品库存和销售业务的企业。

---

## 2. 核心数据模型

### 2.1 商品三层结构 ⭐ 核心

```
商品 (Product)
  ├── 属性：商品名称、商品编码、规格、成分、支数、单位等
  │
  └── 色号 (Color)
        ├── 属性：色号编码、色号名称、颜色描述、颜色样本
        │
        └── 缸号 (Batch)
              ├── 属性：缸号编码、生产日期、供应商、库存数量、单价
              └── 库存位置、备注等
```

**说明：**
- 一个商品可以有多个色号
- 一个色号可以有多个缸号（不同批次）
- 库存管理的最小单位是"缸号"
- 销售和采购都基于"缸号"进行

### 2.2 核心业务实体

#### 2.2.1 商品管理

| 字段 | 类型 | 说明 |
|------|------|------|
| 商品ID | String | 自动生成 |
| 商品名称 | String | 必填 |
| 商品编码 | String | 唯一，必填 |
| 规格 | String | 如"32支" |
| 成分 | String | 如"100%棉" |
| 支数 | String | 如"32s" |
| 单位 | String | 如"公斤" |
| 商品类型 | Enum | 原料/半成品/成品 |
| 创建时间 | DateTime | 自动生成 |
| 更新时间 | DateTime | 自动更新 |

#### 2.2.2 色号管理

| 字段 | 类型 | 说明 |
|------|------|------|
| 色号ID | String | 自动生成 |
| 商品ID | String | 外键 |
| 色号编码 | String | 唯一 |
| 色号名称 | String | 如"天蓝色" |
| 颜色值 | String | HEX颜色值，如"#87CEEB" |
| 颜色描述 | String | 详细描述 |
| 状态 | Enum | 在售/停售 |

#### 2.2.3 缸号管理

| 字段 | 类型 | 说明 |
|------|------|------|
| 缸号ID | String | 自动生成 |
| 色号ID | String | 外键 |
| 缸号编码 | String | 唯一 |
| 生产日期 | Date | 批次日期 |
| 供应商ID | String | 外键 |
| 采购单价 | Decimal | 元/单位 |
| 库存数量 | Decimal | 当前库存 |
| 初始数量 | Decimal | 采购入库数量 |
| 库存位置 | String | 仓库位置 |
| 备注 | Text | 其他信息 |

---

## 3. 七大核心功能模块

### 3.1 进货管理 📦

**功能概述：**
管理从供应商采购纱线的全流程，包括进货单创建、审核、入库等操作。

**核心功能：**

1. **进货单管理**
   - 创建进货单
   - 进货单列表（支持筛选、搜索）
   - 进货单详情查看
   - 进货单编辑/删除
   - 进货单审核/作废

2. **进货单字段**

| 字段 | 类型 | 说明 |
|------|------|------|
| 进货单号 | String | 自动生成，如"CG20231128001" |
| 供应商 | Relation | 选择供应商 |
| 进货日期 | Date | 默认今天 |
| 预计到货日期 | Date | 可选 |
| 进货明细 | Array | 商品→色号→缸号→数量→单价 |
| 总金额 | Decimal | 自动计算 |
| 已付金额 | Decimal | 手动输入 |
| 欠款金额 | Decimal | 自动计算 = 总金额 - 已付金额 |
| 单据状态 | Enum | 待审核/已审核/已入库/已作废 |
| 经办人 | String | 当前用户 |
| 备注 | Text | 其他说明 |

3. **进货单明细结构**

```
进货单明细：
  - 商品选择 → 触发色号列表加载
  - 色号选择 → 输入新缸号编码
  - 缸号编码（新建）
  - 数量
  - 单价
  - 小计（自动计算）
  - 生产日期
  - 库存位置
  - 备注
```

4. **业务流程**
   - 创建进货单 → 填写供应商和日期
   - 添加明细 → 选择商品、色号，输入新缸号、数量、单价
   - 提交审核 → 进货单状态变为"待审核"
   - 审核通过 → 库存自动增加（按缸号）
   - 生成应付账款 → 如有欠款，记录到账款管理

### 3.2 销售管理 💰

**功能概述：**
管理向客户销售纱线的全流程，包括销售单创建、审核、出库等操作。

**核心功能：**

1. **销售单管理**
   - 创建销售单
   - 销售单列表（支持筛选、搜索）
   - 销售单详情查看
   - 销售单编辑/删除
   - 销售单审核/作废

2. **销售单字段**

| 字段 | 类型 | 说明 |
|------|------|------|
| 销售单号 | String | 自动生成，如"XS20231128001" |
| 客户 | Relation | 选择客户 |
| 销售日期 | Date | 默认今天 |
| 预计发货日期 | Date | 可选 |
| 销售明细 | Array | 商品→色号→缸号→数量→单价 |
| 总金额 | Decimal | 自动计算 |
| 已收金额 | Decimal | 手动输入 |
| 欠款金额 | Decimal | 自动计算 |
| 单据状态 | Enum | 待审核/已审核/已出库/已作废 |
| 经办人 | String | 当前用户 |
| 备注 | Text | 其他说明 |

3. **销售单明细结构**

```
销售单明细：
  - 商品选择 → 触发色号列表加载
  - 色号选择 → 触发缸号列表加载（仅显示有库存的缸号）
  - 缸号选择（从现有库存中选择）
  - 数量（不能超过缸号库存）
  - 单价
  - 小计（自动计算）
  - 备注
```

4. **业务流程**
   - 创建销售单 → 填写客户和日期
   - 添加明细 → 选择商品、色号、现有缸号、数量、单价
   - 库存校验 → 检查缸号库存是否充足
   - 提交审核 → 销售单状态变为"待审核"
   - 审核通过 → 库存自动减少（按缸号）
   - 生成应收账款 → 如有欠款，记录到账款管理

### 3.3 库存管理 📊

**功能概述：**
实时查看和管理纱线库存，支持按商品、色号、缸号多维度查询。

**核心功能：**

1. **库存查询**
   - 按商品查看库存
   - 按色号查看库存
   - 按缸号查看详细库存
   - 库存预警（低于安全库存）
   - 库存汇总统计

2. **库存展示结构**

**方式一：按商品展开**
```
商品A（总库存：1000kg）
  ├── 色号1（库存：300kg）
  │     ├── 缸号001（100kg）
  │     ├── 缸号002（120kg）
  │     └── 缸号003（80kg）
  ├── 色号2（库存：400kg）
  └── 色号3（库存：300kg）
```

**方式二：库存明细表**

| 商品 | 色号 | 缸号 | 库存数量 | 单位 | 库存位置 | 供应商 | 入库日期 |
|------|------|------|---------|------|---------|--------|---------|
| 商品A | 色号1 | 001 | 100 | kg | A1区 | 供应商X | 2023-11-01 |
| 商品A | 色号1 | 002 | 120 | kg | A1区 | 供应商X | 2023-11-15 |

3. **库存调整**
   - 盘点调整（实际库存 ≠ 系统库存）
   - 报损登记
   - 库存转移（更改库存位置）

4. **库存预警**
   - 设置安全库存阈值（按商品或色号）
   - 低库存提醒
   - 零库存提醒

### 3.4 账款管理 💳

**功能概述：**
管理与客户的应收账款和与供应商的应付账款。

**核心功能：**

1. **应收账款管理**
   - 应收账款列表（按客户分组）
   - 收款记录
   - 账龄分析
   - 客户欠款汇总

2. **应收账款字段**

| 字段 | 类型 | 说明 |
|------|------|------|
| 账款ID | String | 自动生成 |
| 客户 | Relation | 关联客户 |
| 销售单号 | String | 关联销售单 |
| 应收金额 | Decimal | 销售单总金额 |
| 已收金额 | Decimal | 累计收款 |
| 欠款金额 | Decimal | 应收 - 已收 |
| 账款日期 | Date | 销售单日期 |
| 状态 | Enum | 未结清/已结清 |

3. **收款记录**

| 字段 | 类型 | 说明 |
|------|------|------|
| 收款ID | String | 自动生成 |
| 账款ID | String | 关联应收账款 |
| 收款金额 | Decimal | 本次收款金额 |
| 收款方式 | Enum | 现金/转账/支票等 |
| 收款日期 | Date | 收款日期 |
| 经办人 | String | 当前用户 |
| 备注 | Text | 其他说明 |

4. **应付账款管理**
   - 应付账款列表（按供应商分组）
   - 付款记录
   - 账龄分析
   - 供应商欠款汇总

5. **应付账款字段**（结构与应收类似）

| 字段 | 类型 | 说明 |
|------|------|------|
| 账款ID | String | 自动生成 |
| 供应商 | Relation | 关联供应商 |
| 进货单号 | String | 关联进货单 |
| 应付金额 | Decimal | 进货单总金额 |
| 已付金额 | Decimal | 累计付款 |
| 欠款金额 | Decimal | 应付 - 已付 |
| 账款日期 | Date | 进货单日期 |
| 状态 | Enum | 未结清/已结清 |

### 3.5 客户与供应商管理 👥

**功能概述：**
管理客户和供应商的基本信息及往来记录。

**核心功能：**

1. **客户管理**

| 字段 | 类型 | 说明 |
|------|------|------|
| 客户ID | String | 自动生成 |
| 客户名称 | String | 必填 |
| 客户编码 | String | 唯一 |
| 联系人 | String | 负责人姓名 |
| 联系电话 | String | 手机号 |
| 联系地址 | String | 详细地址 |
| 客户类型 | Enum | 直客/经销商 |
| 信用额度 | Decimal | 最大欠款额度 |
| 状态 | Enum | 正常/冻结 |
| 备注 | Text | 其他信息 |

2. **供应商管理**

| 字段 | 类型 | 说明 |
|------|------|------|
| 供应商ID | String | 自动生成 |
| 供应商名称 | String | 必填 |
| 供应商编码 | String | 唯一 |
| 联系人 | String | 负责人姓名 |
| 联系电话 | String | 手机号 |
| 联系地址 | String | 详细地址 |
| 供应商类型 | Enum | 厂家/贸易商 |
| 结算周期 | Enum | 现结/月结/季结 |
| 状态 | Enum | 合作中/已停用 |
| 备注 | Text | 其他信息 |

3. **往来记录**
   - 查看客户的所有销售单
   - 查看供应商的所有进货单
   - 查看客户的收款记录
   - 查看供应商的付款记录

### 3.6 打单管理 🖨️

**功能概述：**
打印销售单、进货单、出库单等业务单据。

**核心功能：**

1. **可打印单据类型**
   - 销售单（客户联）
   - 进货单（供应商联）
   - 出库单
   - 入库单
   - 收款收据
   - 付款凭证

2. **打印模板**
   - 预设标准模板
   - 支持自定义模板（字段显示/隐藏）
   - 支持添加公司LOGO
   - 支持添加备注说明

3. **打印功能**
   - 单据预览
   - 打印设置（纸张大小、方向等）
   - 批量打印
   - 导出PDF

### 3.7 统计报表 📈

**功能概述：**
提供多维度的数据统计和分析报表。

**核心报表：**

1. **销售报表**
   - 销售日报/月报/年报
   - 按商品统计销售额
   - 按客户统计销售额
   - 按销售员统计业绩
   - 销售趋势分析

2. **进货报表**
   - 进货日报/月报/年报
   - 按商品统计进货量
   - 按供应商统计进货额
   - 进货趋势分析

3. **库存报表**
   - 库存总览
   - 库存周转率
   - 滞销商品分析
   - 库存预警报表

4. **财务报表**
   - 应收账款汇总
   - 应付账款汇总
   - 收支明细
   - 利润分析（销售额 - 进货成本 - 费用）

5. **数据可视化**
   - 柱状图、折线图、饼图
   - 数据导出（Excel、PDF）

---

## 4. 核心业务流程

### 4.1 采购入库流程

```
1. 创建进货单
   ↓
2. 填写供应商信息
   ↓
3. 添加进货明细
   - 选择商品、色号
   - 输入新缸号编码
   - 填写数量、单价
   ↓
4. 保存并提交审核
   ↓
5. 审核通过
   ↓
6. 库存增加（按缸号）
   ↓
7. 生成应付账款（如有欠款）
```

### 4.2 销售出库流程

```
1. 创建销售单
   ↓
2. 填写客户信息
   ↓
3. 添加销售明细
   - 选择商品、色号
   - 从库存中选择缸号
   - 填写数量（检查库存）、单价
   ↓
4. 保存并提交审核
   ↓
5. 审核通过
   ↓
6. 库存减少（按缸号）
   ↓
7. 生成应收账款（如有欠款）
```

### 4.3 收款流程

```
1. 进入应收账款管理
   ↓
2. 选择要收款的账款记录
   ↓
3. 点击"收款"按钮
   ↓
4. 填写收款金额、方式、日期
   ↓
5. 保存收款记录
   ↓
6. 账款欠款金额自动减少
   ↓
7. 如欠款金额 = 0，状态变为"已结清"
```

### 4.4 付款流程

```
1. 进入应付账款管理
   ↓
2. 选择要付款的账款记录
   ↓
3. 点击"付款"按钮
   ↓
4. 填写付款金额、方式、日期
   ↓
5. 保存付款记录
   ↓
6. 账款欠款金额自动减少
   ↓
7. 如欠款金额 = 0，状态变为"已结清"
```

---

## 5. 界面设计建议

### 5.1 整体布局

```
+--------------------------------------------------+
|  LOGO  |  导航栏  |                用户信息  退出  |
+--------------------------------------------------+
|        |                                          |
|  侧边  |                                          |
|  菜单  |              主内容区域                    |
|        |                                          |
|        |                                          |
+--------------------------------------------------+
```

### 5.2 导航菜单结构

```
📦 进货管理
  ├── 进货单列表
  └── 新建进货单

💰 销售管理
  ├── 销售单列表
  └── 新建销售单

📊 库存管理
  ├── 库存查询
  └── 库存调整

💳 账款管理
  ├── 应收账款
  └── 应付账款

👥 客户与供应商
  ├── 客户管理
  └── 供应商管理

🖨️ 打单管理

📈 统计报表
  ├── 销售报表
  ├── 进货报表
  ├── 库存报表
  └── 财务报表

⚙️ 系统设置
  ├── 商品管理
  ├── 色号管理
  └── 用户管理
```

### 5.3 色彩方案

- **主色调：** 蓝色系（#3b82f6）- 专业、可靠
- **成功色：** 绿色（#22c55e）- 入库、收款
- **警告色：** 橙色（#f59e0b）- 库存预警
- **危险色：** 红色（#ef4444）- 出库、删除
- **中性色：** 灰色系 - 文字、边框

### 5.4 响应式设计

- **桌面端（≥1024px）：** 完整布局，侧边栏 + 主内容
- **平板端（768px-1023px）：** 可折叠侧边栏
- **移动端（<768px）：** 底部导航栏 + 汉堡菜单

---

## 6. 技术架构建议

### 6.1 前端技术栈

- **框架：** React 18+
- **UI库：** Tailwind CSS
- **状态管理：** React Context / Zustand
- **路由：** React Router
- **表单：** React Hook Form
- **图标：** Lucide React
- **图表：** Recharts
- **日期：** date-fns

### 6.2 后端技术栈（建议）

- **框架：** Node.js + Express / Nest.js
- **数据库：** PostgreSQL / MySQL
- **ORM：** Prisma / TypeORM
- **认证：** JWT
- **文件上传：** Multer

### 6.3 数据库设计要点

- **商品表** → **色号表** → **缸号表**（三层关联）
- **进货单表** → **进货明细表**
- **销售单表** → **销售明细表**
- **应收账款表** → **收款记录表**
- **应付账款表** → **付款记录表**
- **客户表**、**供应商表**、**用户表**

### 6.4 关键技术点

1. **库存实时性**
   - 使用数据库事务确保库存操作原子性
   - 销售/进货审核时锁定相关库存记录

2. **三层级联查询**
   - 优化商品 → 色号 → 缸号的级联查询性能
   - 使用索引加速查询

3. **数据权限**
   - 用户角色管理（管理员、销售员、仓库管理员等）
   - 数据权限控制（只能查看自己的销售单等）

---

## 7. 项目实施规划

### 7.1 开发阶段划分

**阶段一：基础功能开发（4-6周）**
- 系统框架搭建
- 商品/色号/缸号管理
- 进货管理模块
- 销售管理模块
- 库存查询功能

**阶段二：账款与往来管理（2-3周）**
- 应收账款管理
- 应付账款管理
- 客户与供应商管理
- 收款/付款记录

**阶段三：打单与报表（2-3周）**
- 打单管理功能
- 基础统计报表
- 数据可视化

**阶段四：优化与测试（2-3周）**
- 性能优化
- UI/UX优化
- 功能测试
- 用户培训

### 7.2 优先级排序

**P0 - 核心必备：**
- 商品/色号/缸号管理
- 进货/销售管理
- 库存查询

**P1 - 重要功能：**
- 账款管理
- 客户/供应商管理
- 基础报表

**P2 - 增强功能：**
- 打单管理
- 高级报表
- 数据导出

**P3 - 未来扩展：**
- 移动端APP
- 小程序
- ERP集成

---

**文档结束**

如有疑问或建议，请联系产品团队。
